{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 0833a3b8c54f923bcae6","webpack:///./src/resource_model.js","webpack:///external \"axios\"","webpack:///external \"lodash.defaults\"","webpack:///external \"odd-error_object\"","webpack:///external \"odd-fetching_data_options_service\""],"names":["OPTIONS","WeakMap","DEFAULT_OPTIONS","apiPath","apiVersion","scope","resourceType","attributes","editableAttributes","Base","options","set","get","forEach","attr","errors","isNewRecord","post","apiBasePath","requestBody","put","id","delete","withResourceType","result","all","undefined","data","type","call"],"mappings":"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","file":"odd-resource_model.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"axios\"), require(\"lodash.defaults\"), require(\"odd-error_object\"), require(\"odd-fetching_data_options_service\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"odd-resource_model\", [\"axios\", \"lodash.defaults\", \"odd-error_object\", \"odd-fetching_data_options_service\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"odd-resource_model\"] = factory(require(\"axios\"), require(\"lodash.defaults\"), require(\"odd-error_object\"), require(\"odd-fetching_data_options_service\"));\n\telse\n\t\troot[\"odd-resource_model\"] = factory(root[\"axios\"], root[\"lodash.defaults\"], root[\"odd-error_object\"], root[\"odd-fetching_data_options_service\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_4__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0833a3b8c54f923bcae6","import axios from 'axios'\nimport defaults from 'lodash.defaults'\nimport Errors from 'odd-error_object'\nimport FetchingDataOptionsService from 'odd-fetching_data_options_service'\n\nlet OPTIONS = new WeakMap()\nconst DEFAULT_OPTIONS = {\n  apiPath: '/api',\n  apiVersion: 'v1',\n  scope: 'web',\n  resourceType: 'resources',\n  attributes: [],\n  editableAttributes: []\n}\n\nexport default class Base {\n  constructor(options = {}, attributes = {}) {\n    OPTIONS.set(this, defaults(options, DEFAULT_OPTIONS))\n\n    OPTIONS.get(this).attributes.forEach(attr => {\n      this[attr] = attributes[attr]\n    })\n\n    this.errors = new Errors()\n  }\n\n  /**\n   * 對 API 送出請求，拿回 resources 的 list\n   *\n   * @returns {Promise} 回傳 response 或 errors\n   */\n  static all(options = {}) {\n    return axios.get(`${new this().apiBasePath()}?${FetchingDataOptionsService.call(options)}`)\n  }\n\n  /**\n   * 對 API 送出請求，拿回單一 resource 的內容\n   *\n   * @param {number} id 指定的 resource ID\n   * @returns {Promise} 回傳 response 或 errors\n   */\n  static find(id, options = {}) {\n    return axios.get(`${new this().apiBasePath()}/${id}?${FetchingDataOptionsService.call(options)}`)\n  }\n\n  /**\n   * 把目前的 resource 內容存到 server。\n   *\n   * @returns {Promise} 回傳 response 或 errors\n   */\n  save() {\n    if (this.isNewRecord()) {\n      return axios.post(this.apiBasePath(), this.requestBody())\n    }\n    return axios.put(`${this.apiBasePath()}/${this.id}`, this.requestBody())\n  }\n\n  /**\n   * 刪除目前的 resource\n   *\n   * @returns {Promise} 回傳 response 或 errors\n   */\n  destroy() {\n    return axios.delete(`${this.apiBasePath()}/${this.id}`)\n  }\n\n  /**\n   *  Helpers\n   */\n  apiBasePath(options = {\n    withResourceType: true\n  }) {\n    let result = `${OPTIONS.get(this).apiPath}/${OPTIONS.get(this).apiVersion}/${OPTIONS.get(this).scope}`\n\n    if (options.withResourceType) result += `/${OPTIONS.get(this).resourceType}`\n    return result\n  }\n\n  attributes(options = {}) {\n    let result = {}\n\n    if (options.all) {\n      OPTIONS.get(this).attributes.forEach(attr => {\n        result[attr] = this[attr]\n      })\n    } else {\n      OPTIONS.get(this).editableAttributes.forEach(attr => {\n        result[attr] = this[attr]\n      })\n    }\n\n    return result\n  }\n\n  isNewRecord() {\n    return this.id === undefined\n  }\n\n  requestBody() {\n    return {\n      data: {\n        type: OPTIONS.get(this).resourceType,\n        attributes: this.attributes()\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/resource_model.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.defaults\"\n// module id = 2\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"odd-error_object\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"odd-fetching_data_options_service\"\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}